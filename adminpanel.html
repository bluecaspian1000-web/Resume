<section class="admin-panel">
  <h2>پنل ادمین</h2>

  <div class="login-box">
      <input type="text" id="username" placeholder="نام کاربری">
      <input type="password" id="password" placeholder="رمز عبور">
      <button onclick="login()">ورود</button>
  </div>

  <div id="requests-container" style="display:none; margin-top:20px;">
      <h3>لیست درخواست‌ها</h3>
      <table id="requests-table">
          <thead>
              <tr>
                  <th>نام</th>
                  <th>ایمیل</th>
                  <th>عنوان پروژه</th>
                  <th>توضیحات</th>
              </tr>
          </thead>
          <tbody>
              <!-- درخواست‌ها اینجا می‌آیند -->
          </tbody>
      </table>
  </div>
</section>

<style>
.admin-panel {
    max-width: 1000px;
    margin: 40px auto;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f9f9f9;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

.admin-panel h2 {
    text-align: center;
    color: #0d6efd;
    margin-bottom: 25px;
}

.login-box {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 30px;
}

.login-box input {
    flex: 1 1 calc(50% - 15px);
    padding: 12px 15px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 16px;
    transition: border 0.2s;
}

.login-box input:focus {
    border-color: #0d6efd;
    outline: none;
}

.login-box button {
    padding: 12px 25px;
    border: none;
    border-radius: 8px;
    background: #0d6efd;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
}

.login-box button:hover {
    background: #0b5ed7;
}

#requests-container {
    margin-top: 20px;
}

#requests-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    font-size: 15px;
}

#requests-table th, #requests-table td {
    border: 1px solid #ddd;
    padding: 12px 10px;
    text-align: right;
}

#requests-table th {
    background: #0d6efd;
    color: white;
}

#requests-table tr:nth-child(even) {
    background: #f4f4f4;
}

#requests-table tr:hover {
    background: #e1f0ff;
    transition: background 0.2s;
}
</style>



<script>
let token = "";

async function login() {
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;

    const res = await fetch("https://resume-backend-nmxq.onrender.com/admin/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username, password })
    });

    if(res.ok) {
        const data = await res.json();
        token = data.access_token;
        alert("ورود موفق!");
        loadRequests();
    } else {
        alert("نام کاربری یا رمز اشتباه است");
    }
}

async function loadRequests() {
    const res = await fetch("https://resume-backend-nmxq.onrender.com/admin/requests", {
        headers: { token: token }
    });

    if(!res.ok) {
        alert("خطا در دریافت درخواست‌ها: " + res.status);
        return;
    }

    const data = await res.json();
    const tbody = document.querySelector("#requests-table tbody");
    tbody.innerHTML = "";

    data.forEach(req => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${req.name}</td>
            <td>${req.email}</td>
            <td>${req.title}</td>
            <td>${req.description}</td>
        `;
        tbody.appendChild(tr);
    });

    document.getElementById("requests-container").style.display = "block";
}

</script>

